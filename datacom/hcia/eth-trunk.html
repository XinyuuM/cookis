<!doctype html>
<html lang="zh-Hans" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-hcia" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">配置Eth-Trunk 链路聚合 | 曦语</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://xinyuu.cn/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://xinyuu.cn/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://xinyuu.cn/datacom/hcia/eth-trunk"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="配置Eth-Trunk 链路聚合 | 曦语"><meta data-rh="true" name="description" content="实验介绍"><meta data-rh="true" property="og:description" content="实验介绍"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2024-02-24T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://space.bilibili.com/21977351,https://space.bilibili.com/142202292"><meta data-rh="true" property="article:tag" content="Eth-Trunk"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://xinyuu.cn/datacom/hcia/eth-trunk"><link data-rh="true" rel="alternate" href="https://xinyuu.cn/datacom/hcia/eth-trunk" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://xinyuu.cn/datacom/hcia/eth-trunk" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://xinyuu.cn/datacom/hcia/eth-trunk","mainEntityOfPage":"https://xinyuu.cn/datacom/hcia/eth-trunk","url":"https://xinyuu.cn/datacom/hcia/eth-trunk","headline":"配置Eth-Trunk 链路聚合","name":"配置Eth-Trunk 链路聚合","description":"实验介绍","datePublished":"2024-02-24T00:00:00.000Z","author":[{"@type":"Person","name":"Allalone","description":"编辑","url":"https://space.bilibili.com/21977351","image":"https://static.cocomoe.cn/img/allalone-face.jpg"},{"@type":"Person","name":"Xinyuu","description":"修订","url":"https://space.bilibili.com/142202292","image":"https://static.cocomoe.cn/img/xinyuu-face.jpg"}],"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://xinyuu.cn/datacom/hcia","name":"HCIA 笔记"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="曦语 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="曦语 Atom Feed">







<link rel="alternate" type="application/rss+xml" href="/datacom/hcia/rss.xml" title="曦语 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/datacom/hcia/atom.xml" title="曦语 Atom Feed"><link rel="stylesheet" href="/assets/css/styles.45f918fb.css">
<script src="/assets/js/runtime~main.02612d94.js" defer="defer"></script>
<script src="/assets/js/main.7211650a.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>document.documentElement.setAttribute("data-theme","light"),document.documentElement.setAttribute("data-theme-choice","light"),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><link rel="preload" as="image" href="https://static.cocomoe.cn/img/allalone-face.jpg"><link rel="preload" as="image" href="https://static.cocomoe.cn/img/xinyuu-face.jpg"><link rel="preload" as="image" href="/img/badge-netlify.svg"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Auroral" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="Auroral" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">曦语</b></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="搜索" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="最近博文导航"><div class="sidebarItemTitle_pO2u margin-bottom--md">所有HCIA文章</div><div role="group"><h3 class="yearGroupHeading_rMGB">2024</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/datacom/hcia/kkjcnwudgusa">配置前缀列表</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/datacom/hcia/cc46346ss669dkv">配置高级的访问控制列表</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/datacom/hcia/ccbnviruqss669dkv">配置基本的访问控制列表</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/datacom/hcia/dsadsf5jfgh">配置VRRP多备份组</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/datacom/hcia/mmu870hhcd">配置RIPv2的认证</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_f1Hy">配置Eth-Trunk 链路聚合</h1><div class="container_mt6G margin-vert--md"><time datetime="2024-02-24T00:00:00.000Z">2024年2月24日</time> · <!-- -->阅读需 8 分钟</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://space.bilibili.com/21977351" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://static.cocomoe.cn/img/allalone-face.jpg" alt="Allalone"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://space.bilibili.com/21977351" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp" translate="no">Allalone</span></a></div><small class="authorTitle_nd0D" title="编辑">编辑</small><div class="authorSocials_rSDt"></div></div></div></div><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://space.bilibili.com/142202292" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://static.cocomoe.cn/img/xinyuu-face.jpg" alt="Xinyuu"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://space.bilibili.com/142202292" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp" translate="no">Xinyuu</span></a></div><small class="authorTitle_nd0D" title="修订">修订</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="实验介绍">实验介绍<a href="#实验介绍" class="hash-link" aria-label="实验介绍的直接链接" title="实验介绍的直接链接" translate="no">​</a></h2>
<p>Eth-Trunk（以太网聚合）是一种将多个物理以太网链路（例如，Ethernet 接口）捆绑成一个逻辑链路的技术，以提高链路的带宽和冗余性。通过 Eth-Trunk，多个物理链路可以同时工作，形成一个高带宽的逻辑链路，提供更高的数据传输能力和可靠性。</p>
<p>Eth-Trunk 通过将数据流量在物理链路之间进行分发和负载均衡，以实现链路的聚合。它可以在交换机之间或交换机与服务器之间创建，通常使用一种聚合协议（如 LACP，即链路聚合控制协议）来实现链路的捆绑和管理。</p>
<p>通过 Eth-Trunk，可以实现以下功能：</p>
<ol>
<li class="">增加总带宽：将多个物理链路聚合成一个逻辑链路，增加了可用带宽，提高了数据传输能力。</li>
<li class="">负载均衡：在多个物理链路之间均衡分配数据流量，提高了网络的性能和效率。</li>
<li class="">冗余备份：当某个物理链路出现故障时，Eth-Trunk 可以自动切换到其他可用链路，提供冗余备份，提高网络的可靠性。</li>
</ol>
<p>需要注意的是，Eth-Trunk 的配置需要在网络设备（如交换机）上进行，具体的配置方法和命令可能因厂商和设备型号而有所不同。在配置 Eth-Trunk 之前，需要确保网络设备支持该功能，并按照设备的文档和指导进行操作。</p>
<p><strong>Eth-Trunk 链路聚合的配置模式</strong></p>
<ol>
<li class="">静态链路聚合：静态链路聚合是通过手动配置成员链路来创建 Eth-Trunk。管理员需要明确指定哪些物理链路被绑定到 Eth-Trunk 接口上。静态链路聚合不依赖于任何协议来管理链路的状态，因此它适用于不支持动态链路聚合协议的设备或环境。静态链路聚合的优点是配置简单，不需要额外的协议支持。但缺点是手动配置成员链路，不具备动态监测链路状态和自动恢复故障链路的能力。</li>
<li class="">动态链路聚合：动态链路聚合使用链路聚合控制协议（Link Aggregation Control Protocol，LACP）来管理 Eth-Trunk 接口的成员链路。LACP 协议允许设备自动检测可用链路，并与对端设备进行通信以协商和管理链路的状态。</li>
</ol>
<p>动态链路聚合的优点是具备自动检测链路状态、自动恢复故障链路以及动态负载均衡的能力。它能够根据链路的可用性和设备间的协商来动态调整链路的状态和带宽分配。</p>
<p>需要注意的是，具体支持的链路聚合模式可能因厂商和设备型号而有所不同。在进行链路聚合配置时，建议参考设备的文档和指南，或者联系设备厂商以获取更具体的配置信息。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="实验目的">实验目的<a href="#实验目的" class="hash-link" aria-label="实验目的的直接链接" title="实验目的的直接链接" translate="no">​</a></h3>
<ul>
<li class="">理解使用Eth-Trunk 的应用场景</li>
<li class="">掌握配置Eth-Trunk 链路聚合的方法(手工负载分担模式)</li>
<li class="">掌握配置Eth-Trunk 链路聚合的方法(静态LACP模式)</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="实验内容">实验内容<a href="#实验内容" class="hash-link" aria-label="实验内容的直接链接" title="实验内容的直接链接" translate="no">​</a></h3>
<p>本实验模拟企业网络环境。S1和S2为企业核心交换机，PC-1属于A部门终端设备，PC-2属于B部门终端设备。根据企业规划，S1和S2之间线路原由一条光纤线路相连，但出于带宽和冗余角度考虑需要对其进行升级，可使用Eth-Trunk实现此需求。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="实验拓扑">实验拓扑<a href="#实验拓扑" class="hash-link" aria-label="实验拓扑的直接链接" title="实验拓扑的直接链接" translate="no">​</a></h3>
<p><img decoding="async" loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024225/1.webp" alt="" class="img_ev3q"></p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="实验编址">实验编址<a href="#实验编址" class="hash-link" aria-label="实验编址的直接链接" title="实验编址的直接链接" translate="no">​</a></h3>
<table><thead><tr><th>设备</th><th>接口</th><th>地址</th></tr></thead><tbody><tr><td>PC1</td><td>E0/0/1</td><td>10.0.1.1/24</td></tr><tr><td>PC2</td><td>E0/0/1</td><td>10.0.1.2/24</td></tr></tbody></table>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="实验配置">实验配置<a href="#实验配置" class="hash-link" aria-label="实验配置的直接链接" title="实验配置的直接链接" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="基本配置">基本配置<a href="#基本配置" class="hash-link" aria-label="基本配置的直接链接" title="基本配置的直接链接" translate="no">​</a></h3>
<p><img decoding="async" loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024225/2.webp" alt="" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024225/3.webp" alt="" class="img_ev3q"></p>
<p>其他主机间互相通信测试和上述相同</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="配置链路聚合手工负载分担模式">配置链路聚合（手工负载分担模式）<a href="#配置链路聚合手工负载分担模式" class="hash-link" aria-label="配置链路聚合（手工负载分担模式）的直接链接" title="配置链路聚合（手工负载分担模式）的直接链接" translate="no">​</a></h3>
<p>在<code>S1</code>和<code>S2</code>上配置链路聚合，创建<code>Eth-Trunk 1</code>接口，并指定为手工负载分担模式。</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[Sl]interface Eth-Trunk 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-Eth-Trunk1]mode manual load-balance</span><br></span></code></pre></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S2]interface Eth-Trunk 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-Eth-Trunk1]mode manual load-balance</span><br></span></code></pre></div></div>
<p>将<code>S1</code>和<code>S2</code>的<code>GE /0/1</code> 和<code>GE 0/0/2</code> 分别加入到<code>Eth-Trunk 1</code>接口。</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S1]interface GigabitEthernet 0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/1]eth-trunk 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/1]interface GigabitEthernet 0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/2]eth-trunk 1</span><br></span></code></pre></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S2]interface GigabitEthernet 0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-GigabitEthernet0/0/1]eth-trunk 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-GigabitEthernet0/0/1]interface GigabitEthernet 0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-GigabitEthernet0/0/2]eth-trunk 1</span><br></span></code></pre></div></div>
<p>配置完成后，可以使用<code>display eth-trunk 1</code> 命令查看<code>S1</code>和<code>S2</code>的<code>Eth-Trunk</code>接口状态。</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">display eth-trunk 1</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024225/4.webp" alt="" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024225/5.webp" alt="" class="img_ev3q"></p>
<p>可以观察到，<code>S1</code>与<code>S2</code>的工作模式为<code>NORMAL</code>(手工负载分担方式)，<code>GE0/0/1</code>与<code>GE0/0/2</code>接口已经添加到<code>Eth-Trunk1</code>中，并且处于<code>UP</code> 状态。</p>
<p>使用<code>display interface eth-trunk</code>命令查看<code>S2</code>的<code>Eth-Trunk1</code>接口信息</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">display interface eth-trunk1</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024225/6.webp" alt="" class="img_ev3q"></p>
<p>可以观察到，目前该接口的总带宽是<code>GE 0/0/1</code>与<code>GE0/0/2</code> 接口带宽之和。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="配置链路聚合lacp模式">配置链路聚合（LACP模式）<a href="#配置链路聚合lacp模式" class="hash-link" aria-label="配置链路聚合（LACP模式）的直接链接" title="配置链路聚合（LACP模式）的直接链接" translate="no">​</a></h3>
<p>在<code>S1</code>和<code>S2</code>上配置链路聚合，创建<code>Eth-Trunk 1</code>接口，并指定为静态<code>LACP</code>模式。</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S1]interface Eth-Trunk 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-Eth-Trunk1]mode  lacp-static </span><br></span></code></pre></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S2]interface Eth-Trunk 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-Eth-Trunk1]mode  lacp-static </span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>提示</div><div class="admonitionContent_BuS1"><p>如果在此处出行报错，请将先前已经加入到Eth-Trunk接口下的物理接口删除。</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S1]interface GigabitEthernet [id]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet[id]]undo eth-trunk [id]</span><br></span></code></pre></div></div></div></div>
<p>开启<code>S1</code>与<code>S2</code> 上的<code>GE 0/0/5</code> 接口模拟增加了一条新链路。将<code>S1</code>和<code>S2</code>的<code>GE /0/1</code> 和<code>GE 0/0/2</code> 和<code>GE0/0/5</code>分别加入到<code>Eth-Trunk 1</code>接口。</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S1]interface GigabitEthernet 0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/1]eth-trunk 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/1]interface GigabitEthernet 0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/2]eth-trunk 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/2]interface GigabitEthernet 0/0/5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/5]eth-trunk </span><br></span></code></pre></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S2]interface GigabitEthernet 0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-GigabitEthernet0/0/1]eth-trunk 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-GigabitEthernet0/0/1]interface GigabitEthernet 0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-GigabitEthernet0/0/2]eth-trunk 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-GigabitEthernet0/0/2]interface GigabitEthernet 0/0/5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S2-GigabitEthernet0/0/5]eth-trunk 1</span><br></span></code></pre></div></div>
<p>配置完成后，使用<code>display eth-trunk 1</code> 命令查看<code>S1</code>和<code>S2</code>的<code>Eth-Trunk 1</code>接口状态。</p>
<p><img decoding="async" loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024225/7.webp" alt="" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024225/8.webp" alt="" class="img_ev3q"></p>
<p>可以观察到，3个接口默认都处于活动状态(Selected)。</p>
<p>将<code>S1</code>的系统优先级从默认的<code>32768</code>改为<code>100</code>，使其成为主动端(值越低优先级越高)，并按照主动端设备的接口来选择活动接口。</p>
<p>两端设备选出主动端后，两端都会以主动端的接口优先级来选择活动接口。</p>
<p>两端设备选择了一致的活动接口，活动链路组便可以建立起来，设置这些活动链路以负载分担的方式转发数据。</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S1]lacp priority 100</span><br></span></code></pre></div></div>
<p>配置完成后，查看<code>S1</code>的<code>Eth-Trunk1</code>接口状态。</p>
<p><img decoding="async" loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024225/9.webp" alt="" class="img_ev3q"></p>
<p>可以观察到，已经将<code>S1</code>的<code>LACP</code>系统优先级改为<code>100</code>，而<code>S2</code>没修改:仍为默认值。</p>
<p>在<code>S1</code>上配置活动接口上限阈值为<code>2</code>。</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S1]interface Eth-Trunk 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-Eth-Trunk1]max active-linknumber 2</span><br></span></code></pre></div></div>
<p>在<code>S1</code>上配置接口的优先级确定活动链路。</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S1]interface GigabitEthernet 0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/1]lacp priority 100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/1]interface GigabitEthernet 0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/2]lacp priority 100</span><br></span></code></pre></div></div>
<p>配置接口的活动优先级将默认的<code>32768</code> 改为<code>100</code>，目的是使<code>GE0/0/1</code>和<code>GE 0/0/2</code> 接口成为活动状态。</p>
<p>配置完成后，查看<code>S1</code>的<code>Eth-Trunk1</code>接口状态。</p>
<p><img decoding="async" loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024225/10.webp" alt="" class="img_ev3q"></p>
<p>可以观察到，由于将接口的阈值改为2(默认活动接口最大阈值为8)。</p>
<p>该Eth-Trunk接口下将只有两个成员处于活动状态，并且具有负载分担能力。</p>
<p>而GE0/0/5接口已处于不活动状态(Unselect)，该链路作为备份链路。</p>
<p>当活动链路出现故障时，备份链路将会替代故障链路，保持数据传输的可靠性。</p>
<p>将<code>S1</code>的<code>GE 0/0/1</code>接口关闭，验证Eth-Trunk链路聚合信息。</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[S1]interface GigabitEthernet 0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/1]shutdown</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/1]display eth-trunk 1</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" src="https://static.cocomoe.cn/static/hcialab/2024225/11.webp" alt="" class="img_ev3q"></p>
<p>可以观察到，S1的GE0/0/1接口已经处于不活动状态，而GE0/0/5 接口为活动状态。</p>
<p>如果将S1的 GE 0/0/1 接口开启后，又会恢复为活动状态，GE 0/0/5 则为不活动状态。</p>
<p>至此，完成了整个Eth-Trunk的部署。</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="end">End.<a href="#end" class="hash-link" aria-label="End.的直接链接" title="End.的直接链接" translate="no">​</a></h2></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>标签：</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/datacom/hcia/tags/eth-trunk">Eth-Trunk</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="博文分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/datacom/hcia/staicrouter"><div class="pagination-nav__sublabel">较新一篇</div><div class="pagination-nav__label">静态路由和默认路由的配置（remake）</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/datacom/hcia/smart-link-and-monitor-link"><div class="pagination-nav__sublabel">较旧一篇</div><div class="pagination-nav__label">Smart Link与Monitor Link</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#实验介绍" class="table-of-contents__link toc-highlight">实验介绍</a><ul><li><a href="#实验目的" class="table-of-contents__link toc-highlight">实验目的</a></li><li><a href="#实验内容" class="table-of-contents__link toc-highlight">实验内容</a></li><li><a href="#实验拓扑" class="table-of-contents__link toc-highlight">实验拓扑</a></li><li><a href="#实验编址" class="table-of-contents__link toc-highlight">实验编址</a></li></ul></li><li><a href="#实验配置" class="table-of-contents__link toc-highlight">实验配置</a><ul><li><a href="#基本配置" class="table-of-contents__link toc-highlight">基本配置</a></li><li><a href="#配置链路聚合手工负载分担模式" class="table-of-contents__link toc-highlight">配置链路聚合（手工负载分担模式）</a></li><li><a href="#配置链路聚合lacp模式" class="table-of-contents__link toc-highlight">配置链路聚合（LACP模式）</a></li></ul></li><li><a href="#end" class="table-of-contents__link toc-highlight">End.</a></li></ul></div></div></div></div></div><footer class="custom-footer-container"><div class="custom-footer-card"><div class="custom-footer-content"><div class="footer-section"><h3 class="footer-section-title">友情链接</h3><ul class="footer-links-list"><li><button class="safeLink_T1KN withWarning_fEbE footer-link" type="button">Hazx小屋<span class="visuallyHidden_Xk29">（外部链接，点击查看警告）</span></button></li></ul></div><div class="footer-section"><h3 class="footer-section-title">快速导航</h3><ul class="footer-links-list"><li><a class="footer-link" href="/datacom/hcia"> Datacom-HCIA</a></li><li><a class="footer-link" href="/legacy">关于曦语</a></li><li><a class="footer-link" href="/love"> 我们的故事</a></li></ul></div><div class="footer-section"><h3 class="footer-section-title">法律信息</h3><p class="footer-copyright">©2021-<!-- -->2025<!-- --> <!-- -->Xinyuu<!-- -->. All rights reserved.</p><p class="footer-beian"><a href="https://icp.gov.moe/?keyword=20250737" target="_blank" rel="noopener noreferrer" class="footer-beian-link">萌ICP备20250737号</a></p><p class="footer-tech">Built with❤ <a href="https://docusaurus.io" target="_blank" rel="noopener noreferrer">Docusaurus</a>.</p><img src="/img/badge-netlify.svg" alt="Deploys by Netlify" width="114" height="51"></div></div></div></footer></div>
</body>
</html>