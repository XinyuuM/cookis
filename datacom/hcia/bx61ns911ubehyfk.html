<!doctype html>
<html lang="zh-Hans" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-hcia" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">利用三层交换机实现VLAN 间路由 | 曦语</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://xinyuu.cn/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://xinyuu.cn/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://xinyuu.cn/datacom/hcia/bx61ns911ubehyfk"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="利用三层交换机实现VLAN 间路由 | 曦语"><meta data-rh="true" name="description" content="实验介绍"><meta data-rh="true" property="og:description" content="实验介绍"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2024-01-30T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://space.bilibili.com/21977351"><meta data-rh="true" property="article:tag" content="VLAN,实验,交换机"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://xinyuu.cn/datacom/hcia/bx61ns911ubehyfk"><link data-rh="true" rel="alternate" href="https://xinyuu.cn/datacom/hcia/bx61ns911ubehyfk" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://xinyuu.cn/datacom/hcia/bx61ns911ubehyfk" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://xinyuu.cn/datacom/hcia/bx61ns911ubehyfk","mainEntityOfPage":"https://xinyuu.cn/datacom/hcia/bx61ns911ubehyfk","url":"https://xinyuu.cn/datacom/hcia/bx61ns911ubehyfk","headline":"利用三层交换机实现VLAN 间路由","name":"利用三层交换机实现VLAN 间路由","description":"实验介绍","datePublished":"2024-01-30T00:00:00.000Z","author":{"@type":"Person","name":"Allalone","description":"编辑","url":"https://space.bilibili.com/21977351","image":"https://static.cocomoe.cn/img/allalone-face.jpg"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://xinyuu.cn/datacom/hcia","name":"HCIA 笔记"}}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="曦语 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="曦语 Atom Feed">







<link rel="alternate" type="application/rss+xml" href="/datacom/hcia/rss.xml" title="曦语 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/datacom/hcia/atom.xml" title="曦语 Atom Feed"><link rel="stylesheet" href="/assets/css/styles.5039649e.css">
<script src="/assets/js/runtime~main.0626f5d4.js" defer="defer"></script>
<script src="/assets/js/main.9ba6c89f.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>document.documentElement.setAttribute("data-theme","light"),document.documentElement.setAttribute("data-theme-choice","light"),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><link rel="preload" as="image" href="https://static.cocomoe.cn/img/allalone-face.jpg"><link rel="preload" as="image" href="/img/badge-netlify.svg"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Auroral" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="Auroral" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">曦语</b></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="搜索" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="最近博文导航"><div class="sidebarItemTitle_pO2u margin-bottom--md">所有HCIA文章</div><div role="group"><h3 class="yearGroupHeading_rMGB">2024</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/datacom/hcia/kkjcnwudgusa">配置前缀列表</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/datacom/hcia/cc46346ss669dkv">配置高级的访问控制列表</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/datacom/hcia/ccbnviruqss669dkv">配置基本的访问控制列表</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/datacom/hcia/dsadsf5jfgh">配置VRRP多备份组</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/datacom/hcia/mmu870hhcd">配置RIPv2的认证</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_f1Hy">利用三层交换机实现VLAN 间路由</h1><div class="container_mt6G margin-vert--md"><time datetime="2024-01-30T00:00:00.000Z">2024年1月30日</time> · <!-- -->阅读需 5 分钟</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://space.bilibili.com/21977351" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://static.cocomoe.cn/img/allalone-face.jpg" alt="Allalone"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://space.bilibili.com/21977351" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp" translate="no">Allalone</span></a></div><small class="authorTitle_nd0D" title="编辑">编辑</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="实验介绍">实验介绍<a href="#实验介绍" class="hash-link" aria-label="实验介绍的直接链接" title="实验介绍的直接链接" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="关于本实验的所需要的知识点补充">关于本实验的所需要的知识点补充<a href="#关于本实验的所需要的知识点补充" class="hash-link" aria-label="关于本实验的所需要的知识点补充的直接链接" title="关于本实验的所需要的知识点补充的直接链接" translate="no">​</a></h3>
<p><strong>vlanif</strong></p>
<p>VLANIF（Virtual Local Area Network Interface）是一种虚拟局域网接口，它是基于 VLAN 技术的扩展。在网络中，VLAN 是一种将局域网划分成多个虚拟局域网的技术，可以在单个物理网络中实现逻辑上的隔离和划分。而 VLANIF 就是在每个虚拟局域网中创建的一个虚拟接口，用于与该虚拟局域网内的设备进行交互和通信。VLANIF 接口可以配置 IP 地址和其他网络参数，实现虚拟局域网中的互联和通信功能。它在网络中起到连接不同 VLAN 之间的桥梁作用，可以将不同的 VLAN 划分成多个子网，并提供路由功能，实现不同子网之间的通信。</p>
<p>VLANIF 之间的路由是指不同 VLANIF 接口之间进行网络路由的过程。在一个网络中，每个 VLANIF 接口都代表一个虚拟局域网，而这些虚拟局域网可能存在跨网段的通信需求。为了实现不同 VLANIF 之间的通信，需要进行路由配置。</p>
<p>在路由器或三层交换机上，需要创建虚拟接口并将其分配给相应的 VLAN。这些虚拟接口通常称为 SVI（Switched Virtual Interface），每个 SVI 与一个 VLAN 关联。通过在 SVI 上配置 IP 地址和子网掩码，可以为每个 VLAN 创建一个虚拟网关。</p>
<p>当数据包从一个 VLANIF 接口发送到另一个 VLANIF 接口时，数据包首先到达路由器或三层交换机上的 SVI 接口。然后，根据路由表中的路由信息，决定数据包应该被发送到哪个目标 VLANIF 接口。</p>
<p>通过在路由器或三层交换机上配置适当的路由策略和路由协议，可以实现 VLANIF 之间的互联和通信。这样，不同 VLAN 中的主机就可以通过 VLANIF 之间的路由进行互相访问和通信。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="实验目的">实验目的<a href="#实验目的" class="hash-link" aria-label="实验目的的直接链接" title="实验目的的直接链接" translate="no">​</a></h3>
<ol>
<li class="">掌握配置VLANIF接口的方法</li>
<li class="">理解数据包跨VLAN路由的原理</li>
<li class="">掌握测试多层交换网络连通性的方法</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="实验内容">实验内容<a href="#实验内容" class="hash-link" aria-label="实验内容的直接链接" title="实验内容的直接链接" translate="no">​</a></h3>
<p>本实验模拟企业网络场景。公司有两个部门--销售部和客服部，分别规划使用VLAN 10和VLAN20。其中销售部下有两台终端PC-1和PC-2，客服部下有一台终端PC-3。所有终端都通过核心三层交换机S1相连。现需要让该公司所有三台主机都能实现互相访问，网络管理员将通过配置三层交换机来实现。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="实验拓扑">实验拓扑<a href="#实验拓扑" class="hash-link" aria-label="实验拓扑的直接链接" title="实验拓扑的直接链接" translate="no">​</a></h3>
<p><img decoding="async" loading="lazy" src="/assets/images/1-9c6d9cb29b3b04af4b85058a5449f57a.png" width="829" height="639" class="img_ev3q"></p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="实验编址">实验编址<a href="#实验编址" class="hash-link" aria-label="实验编址的直接链接" title="实验编址的直接链接" translate="no">​</a></h3>
<table><tr><th>设备</th><th>接口</th><th>IP地址/掩码</th><th>网关</th></tr><tr><th>PC1</th><td>E0/0/1</td><td>192.168.1.1/24</td><td>192.168.1.254</td></tr><tr><th>PC2</th><td>E0/0/1</td><td>192.168.1.2/24</td><td>192.168.1.254</td></tr><tr><th>PC3</th><td>E0/0/1</td><td>192.168.2.1/24</td><td>192.168.2.254</td></tr><tr><th rowspan="4">S1</th></tr><tr><td>VLANIF10</td><td>192.168.1.254</td></tr><tr><td>VLANIF20</td><td>192.168.2.254</td></tr></table>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="基本配置">基本配置<a href="#基本配置" class="hash-link" aria-label="基本配置的直接链接" title="基本配置的直接链接" translate="no">​</a></h2>
<p><img decoding="async" loading="lazy" src="/assets/images/2-00ad94d77e6a08b351a3a2496f90fdfe.png" width="781" height="533" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="/assets/images/3-aaaff95d4ae76d08702f0b0558bb6734.png" width="781" height="533" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="/assets/images/4-3447e00ceb6bc743cf134e2ecd49752d.png" width="781" height="533" class="img_ev3q"></p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="其他操作">其他操作<a href="#其他操作" class="hash-link" aria-label="其他操作的直接链接" title="其他操作的直接链接" translate="no">​</a></h3>
<p>配置三层交换机实现VLAN间通信通过在交换机上设置不同的VLAN使得主机实现相互隔离。在三层交换机S1上创建VLAN10和VLAN 20，把销售部的主机全部划入VLAN 10 中，客服部的主机划入VLAN 20 中。</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1]vlan 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-vlan10]vlan 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-vlan20]interface GigabitEthernet0/0/1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/1]port link-type access</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/1]port default VLAN 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/1]interface GigabitEthernet0/0/2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/2]port link-type access</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/2]port default VLAN 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/2]interface GigabitEthernet0/0/3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/3]port link-type access</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-GigabitEthernet0/0/3]port default VLAN 20</span><br></span></code></pre></div></div>
<p>在S1上使用 interface VLANif命令创建 VLANIF 接口，指定VLANIF 接口所对应的 VLAN ID 为10，并进入 VLANIF 接口视图，在接口视图下配置IP 地址192.168.1.254/24。再创建 对应 VLAN 20 的VLANIF 接口，地址配置为192.168.2.254/24。</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1]interface VLANif 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-VLANif10]ip address 192.168.1.254 24</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-VLANif10]interface VLANif 20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[S1-VLANif20]ip address 192.168.2.254 24</span><br></span></code></pre></div></div>
<p>配置完成后，查看接口状态。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/5-02b8910fe077072e45f68534851f8ad3.png" width="1080" height="419" class="img_ev3q"></p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="结果验证">结果验证<a href="#结果验证" class="hash-link" aria-label="结果验证的直接链接" title="结果验证的直接链接" translate="no">​</a></h2>
<p><img decoding="async" loading="lazy" src="/assets/images/6-ccd5ada9fc87805e85ab0a610cdf227d.png" width="781" height="533" class="img_ev3q"></p>
<p>可见通信正常，实现了销售部终端与客服部终端间的通信。PC-2上的测试省略。</p>
<p><strong>本文完</strong></p></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>标签：</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/datacom/hcia/tags/vlan">VLAN</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/datacom/hcia/tags/实验">实验</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/datacom/hcia/tags/交换机">交换机</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="博文分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/datacom/hcia/stp-set"><div class="pagination-nav__sublabel">较新一篇</div><div class="pagination-nav__label">STP简单配置</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/datacom/hcia/rw6oklzd03ngri7n"><div class="pagination-nav__sublabel">较旧一篇</div><div class="pagination-nav__label">利用单臂路由实现VLAN间路由</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#实验介绍" class="table-of-contents__link toc-highlight">实验介绍</a><ul><li><a href="#关于本实验的所需要的知识点补充" class="table-of-contents__link toc-highlight">关于本实验的所需要的知识点补充</a></li><li><a href="#实验目的" class="table-of-contents__link toc-highlight">实验目的</a></li><li><a href="#实验内容" class="table-of-contents__link toc-highlight">实验内容</a></li><li><a href="#实验拓扑" class="table-of-contents__link toc-highlight">实验拓扑</a></li><li><a href="#实验编址" class="table-of-contents__link toc-highlight">实验编址</a></li></ul></li><li><a href="#基本配置" class="table-of-contents__link toc-highlight">基本配置</a><ul><li><a href="#其他操作" class="table-of-contents__link toc-highlight">其他操作</a></li></ul></li><li><a href="#结果验证" class="table-of-contents__link toc-highlight">结果验证</a></li></ul></div></div></div></div></div><footer class="custom-footer-container"><div class="custom-footer-card"><div class="custom-footer-content"><div class="footer-section"><h3 class="footer-section-title">友情链接</h3><ul class="footer-links-list"></ul></div><div class="footer-section"><h3 class="footer-section-title">快速导航</h3><ul class="footer-links-list"><li><a class="footer-link" href="/datacom/hcia"> Datacom-HCIA</a></li><li><a class="footer-link" href="/legacy">关于曦语</a></li><li><a class="footer-link" href="/love"> 我们的故事</a></li></ul></div><div class="footer-section"><h3 class="footer-section-title">法律信息</h3><p class="footer-copyright">©2021-<!-- -->2025<!-- --> <!-- -->Xinyuu<!-- -->. All rights reserved.</p><p class="footer-beian"><a href="https://icp.gov.moe/?keyword=20250737" target="_blank" rel="noopener noreferrer" class="footer-beian-link">萌ICP备20250737号</a></p><p class="footer-tech">Built with❤ <a href="https://docusaurus.io" target="_blank" rel="noopener noreferrer">Docusaurus</a>.</p><img src="/img/badge-netlify.svg" alt="Deploys by Netlify" width="114" height="51"></div></div></div></footer></div>
</body>
</html>